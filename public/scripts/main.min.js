function openSubreddit(e){var t="http://www.reddit.com/r/"+e+"/hot.json?jsonp=?";$.ajax(t,{dataType:"jsonp",success:function(e,t,n){if(e.kind=="Listing"){var r=listingTemplate(e.data);$("#results").html(r)}else console.log("API didn't return listing")}})}function openLink(e){$parentli=e.closest("li"),$parentli.siblings().removeClass("active"),$parentli.addClass("active");var t=$("#browser"),n=e.attr("href");t.addClass("active"),t.empty();if(n.substr(-4)==".jpg"){var r=$("<img />");r.attr("src",n),r.appendTo(t)}else{var i=$("<iframe></iframe>");i.attr("src",n),i.appendTo(t)}}function prev(){var e=$("#results li.active");if(e.length==0)var t=$("#results li").last();else var t=e.prev();t.length>0&&openLink(t.find("a.internal"))}function next(){var e=$("#results li.active");if(e.length==0)var t=$("#results li").first();else var t=e.next();t.length>0&&openLink(t.find("a.internal"))}Handlebars.registerHelper("debug",function(e){console.log("Current Context"),console.log("===================="),console.log(this),e&&(console.log("Value"),console.log("===================="),console.log(e))}),Handlebars.registerHelper("date",function(e){var t=new Date,n=e*1e3,r=t.getTimezoneOffset()*60*1e3,i=n-r;console.log(n),console.log(r),console.log(i);var s=t.getTime()-i,o=s/6e4;return o>1440?Math.round(o/1440)+" days ago":o>60?Math.round(o/60)+" hours ago":Math.round(o)+" minutes ago"});var listingTemplate=Handlebars.compile($("#listing-template").html());$(function(){$("#open-btn").on("click",function(e){var t=$("#subreddit").val();t==""&&(t="pics"),openSubreddit(t),$("#browser").removeClass("active"),e.preventDefault()}),$(document).on("mouseenter","#browser",function(e){$("#browser").children().length>0&&$("#browser").addClass("active")}),$(document).on("mouseleave","#browser",function(e){$("#browser").removeClass("active")}),$(document).on("click","a.internal",function(e){openLink($(this)),e.preventDefault()}),$(document).on("keydown",function(e){switch(e.which){case 40:next(),e.preventDefault();break;case 38:prev(),e.preventDefault();break;case 39:$("#browser").removeClass("active"),e.preventDefault();break;case 37:$("#browser").addClass("active"),e.preventDefault();break;default:console.log(e.which)}})});